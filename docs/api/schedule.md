# ê·¼ë¬´ ì¼ì • API (Work Schedule)

## ğŸ“‘ ëª©ì°¨
- [ê°œìš”](#-ê°œìš”)
- [ì¸ì¦](#-ì¸ì¦)
- [ê·¼ë¬´ ì¼ì • ì‹ ì²­](#-ê·¼ë¬´-ì¼ì •-ì‹ ì²­)
- [ê·¼ë¬´ ì¼ì • ìˆ˜ì •](#-ê·¼ë¬´-ì¼ì •-ìˆ˜ì •)
- [ê·¼ë¬´ ì¼ì • ì¡°íšŒ](#-ê·¼ë¬´-ì¼ì •-ì¡°íšŒ)
- [ê·¼ë¬´ ì¼ì • ì·¨ì†Œ](#-ê·¼ë¬´-ì¼ì •-ì·¨ì†Œ)
- [ê²€ì¦ ê·œì¹™](#-ê²€ì¦-ê·œì¹™)
- [ê´€ë ¨ ë¬¸ì„œ](#-ê´€ë ¨-ë¬¸ì„œ)

---

## ğŸ“– ê°œìš”

ì‚¬ìš©ìì˜ ê·¼ë¬´ ì¼ì •ì„ ê´€ë¦¬í•˜ëŠ” APIì…ë‹ˆë‹¤. ì¼ì • ì‹ ì²­, ìˆ˜ì •, ì¡°íšŒ, ì·¨ì†Œ ê¸°ëŠ¥ì„ ì œê³µí•˜ë©°,
ë³µì¡í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ê²€ì¦ ë¡œì§(ì‹œê°„ ì œí•œ, ë™ì‹œ ì¸ì› ì œí•œ ë“±)ì„ í¬í•¨í•©ë‹ˆë‹¤.

**Base Path**: `/api/v1/work-schedules`

**ì£¼ìš” ê¸°ëŠ¥**:
- ê·¼ë¬´ ì¼ì • ì¼ê´„ ì‹ ì²­ (ë¶€ë¶„ ì„±ê³µ/ì‹¤íŒ¨ ì§€ì›)
- ê¸°ì¡´ ì¼ì • ìˆ˜ì • (ì‹œê°„ ë³´ì¡´ ì›ì¹™)
- ì›”ë³„/ì´ë ¥ ì¡°íšŒ
- ì¼ì • ì·¨ì†Œ (ì¦‰ì‹œ/ìš”ì²­)

---

## ğŸ” ì¸ì¦

**ì¸ì¦ ë°©ì‹**: `Authorization: Bearer <AccessToken>` í—¤ë”ë¡œ JWT AccessToken ì „ë‹¬

**ì¸ì¦ ì²˜ë¦¬**:
- Spring Securityì—ì„œ ê°•ì œ ì¸ì¦í•˜ì§€ ì•ŠìŒ (SecurityConfigì—ì„œ `permitAll`)
- ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ `@AuthenticationPrincipal CustomUserDetails userDetails` íŒŒë¼ë¯¸í„°ë¡œ ì¸ì¦ ì •ë³´ ìš”ì²­
- **ì‹¤ì œ í˜¸ì¶œ ì‹œì—ëŠ” ë°˜ë“œì‹œ AccessTokenì„ í¬í•¨**í•´ì•¼ í•¨

**ë²”ìœ„ ì œí•œ**:
- ë³¸ì¸ì˜ ì¼ì •ë§Œ ì¡°íšŒ/ìˆ˜ì • ê°€ëŠ¥
- íƒ€ì¸ì˜ ì¼ì •ì€ ì ‘ê·¼ ë¶ˆê°€ëŠ¥ (ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ userId ê²€ì¦)
- ê´€ë¦¬ì API(`/api/v1/admin/*`)ë¥¼ í†µí•´ì„œë§Œ ì „ì²´ ì¼ì • ì¡°íšŒ/ê´€ë¦¬ ê°€ëŠ¥

---

## ğŸ“ ê·¼ë¬´ ì¼ì • ì‹ ì²­

### 2.1 ê·¼ë¬´ ì¼ì • ì¼ê´„ ì‹ ì²­

**Endpoint**: `POST /api/v1/work-schedules/apply`

**ì„¤ëª…**: ì—¬ëŸ¬ ê·¼ë¬´ ì‹œê°„ëŒ€ë¥¼ ì¼ê´„ ì‹ ì²­í•©ë‹ˆë‹¤. ì‹ ì²­ ê¸°ê°„ ë‚´ë¼ë©´ ìë™ ìŠ¹ì¸(`WS02`)ë˜ë©°, ê¸°ê°„ ì™¸ë¼ë©´ ìŠ¹ì¸ ëŒ€ê¸° ìƒíƒœ(`WS01`)ë¡œ ë“±ë¡ë©ë‹ˆë‹¤.

#### Request

**Headers**:
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```
â€» ì»¨íŠ¸ë¡¤ëŸ¬ê°€ `@AuthenticationPrincipal`ì„ ì‚¬ìš©í•˜ë¯€ë¡œ ì‹¤ì œ í˜¸ì¶œ ì‹œ í† í°ì´ í•„ìš”í•©ë‹ˆë‹¤.  
â€» í˜„ì¬ êµ¬í˜„ì€ ì‚¬ìš©ì IDë¥¼ ì¸ì¦ ì •ë³´ê°€ ì•„ë‹Œ **ê³ ì •ê°’(1)**ìœ¼ë¡œ ì‚¬ìš©í•©ë‹ˆë‹¤.

**Body**:
```json
{
  "slots": [
    {
      "start": "2026-01-22T09:00:00",
      "end": "2026-01-22T12:00:00"
    },
    {
      "start": "2026-01-22T14:00:00",
      "end": "2026-01-22T16:00:00"
    }
  ]
}
```

#### Response

**Success - ì „ì²´ ì„±ê³µ (201 Created)**:
```json
{
  "isSuccess": true,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì •ì´ ëª¨ë‘ ë“±ë¡ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "details": {
    "success": [
      {
        "start": "2026-01-22T09:00:00",
        "end": "2026-01-22T12:00:00"
      },
      {
        "start": "2026-01-22T14:00:00",
        "end": "2026-01-22T16:00:00"
      }
    ],
    "fail": []
  }
}
```

**Partial Success - ë¶€ë¶„ ì„±ê³µ (207 Multi-Status)**:
```json
{
  "isSuccess": false,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì • ì¤‘ ì‹¤íŒ¨í•œ ì¼ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤.",
  "details": {
    "success": [
      {
        "start": "2026-01-22T09:00:00",
        "end": "2026-01-22T12:00:00"
      }
    ],
    "fail": [
      {
        "start": "2026-01-22T14:00:00",
        "end": "2026-01-22T16:00:00"
      }
    ]
  }
}
```

**Error - ì „ì²´ ì‹¤íŒ¨ (422 Unprocessable Entity)**:
```json
{
  "isSuccess": false,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì •ì´ ëª¨ë‘ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.",
  "details": {
    "success": [],
    "fail": [
      {
        "start": "2026-01-22T09:00:00",
        "end": "2026-01-22T10:30:00"
      }
    ]
  }
}
```

#### ìƒíƒœ ê²°ì • ë¡œì§

| ì‹ ì²­ ì‹œì  | ìƒíƒœ | ì½”ë“œ | ì„¤ëª… |
|----------|------|------|------|
| **ì‹ ì²­ ê¸°ê°„ ë‚´** | ìŠ¹ì¸ë¨ | `WS02` | ì¦‰ì‹œ ìŠ¹ì¸, ê²€ì¦ í†µê³¼ ì‹œ ë°”ë¡œ ê·¼ë¬´ ê°€ëŠ¥ |
| **ì‹ ì²­ ê¸°ê°„ ì™¸** | ì‹ ì²­ë¨ | `WS01` | ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° |

#### ê²€ì¦ ê·œì¹™

ëª¨ë“  ì‹ ì²­ì€ ë‹¤ìŒ ê²€ì¦ì„ í†µê³¼í•´ì•¼ í•©ë‹ˆë‹¤:

1. **ìµœì†Œ ê·¼ë¬´ ì‹œê°„**: 1íšŒ **2ì‹œê°„ ì´ìƒ** (`MIN_WORK_TIME_NOT_MET`)
2. **ì›” ì´ëŸ‰ ì œí•œ**: ì›” ìµœëŒ€ **27ì‹œê°„** (`TOTAL_WORK_TIME_EXCEEDED`)
3. **ì£¼ ì´ëŸ‰ ì œí•œ**: ì£¼ ìµœëŒ€ **13ì‹œê°„** (`WEEKLY_WORK_TIME_EXCEEDED`)
4. **ë™ì‹œ ê·¼ë¬´ ì¸ì›**: 15ë¶„ ë‹¨ìœ„ë¡œ ê²¹ì¹˜ëŠ” ì¸ì›ì´ `MonthlyScheduleConfig.maxConcurrent`ë¥¼ ì´ˆê³¼í•˜ëŠ”ì§€ ê²€ì‚¬

#### Edge Cases

| ìƒí™© | ì²˜ë¦¬ ë°©ì‹ |
|------|----------|
| **ë¶€ë¶„ ì„±ê³µ** | 3ê°œ ì‹ ì²­ ì¤‘ 1ê°œë§Œ ì‹œê°„ ê²¹ì¹¨ìœ¼ë¡œ ì‹¤íŒ¨ â†’ 2ê°œëŠ” ì €ì¥, 1ê°œëŠ” ì‹¤íŒ¨ ì‘ë‹µì— í¬í•¨ (207) |
| **ë™ì‹œì„± ì´ìŠˆ** | ë§ˆì§€ë§‰ 1ìë¦¬ë¥¼ ë‘ê³  ë™ì‹œì— ì‹ ì²­ ì‹œ DB ë½ ë˜ëŠ” ì• í”Œë¦¬ì¼€ì´ì…˜ ë ˆë²¨ ê²€ì¦ìœ¼ë¡œ ì²˜ë¦¬ |
| **ê³¼ê±° ë‚ ì§œ ì‹ ì²­** | í˜„ì¬ ë¡œì§ì— ê³¼ê±° ë‚ ì§œ ê²€ì¦ì´ ì—†ìŒ |

---

## âœï¸ ê·¼ë¬´ ì¼ì • ìˆ˜ì •

### 3.1 ê·¼ë¬´ ì¼ì • ìˆ˜ì •

**Endpoint**: `PATCH /api/v1/work-schedules/modify`

**ì„¤ëª…**: ê¸°ì¡´ ì¼ì •ì„ ì·¨ì†Œí•˜ê³  ìƒˆë¡œìš´ ì¼ì •ì„ ì¶”ê°€í•©ë‹ˆë‹¤. **"ê·¼ë¬´ ì‹œê°„ ë³´ì¡´ì˜ ë²•ì¹™"** - ì·¨ì†Œí•˜ëŠ” ì´ ì‹œê°„ê³¼ ì¶”ê°€í•˜ëŠ” ì´ ì‹œê°„ì´ ë™ì¼í•´ì•¼ í•©ë‹ˆë‹¤.

#### Request

**Headers**:
```
Authorization: Bearer <JWT_TOKEN>
Content-Type: application/json
```

**Body**:
```json
{
  "applySlots": [
    {
      "start": "2026-01-25T10:00:00",
      "end": "2026-01-25T13:00:00"
    }
  ],
  "cancelScheduleIds": [123],
  "reason": "ì¼ì • ë³€ê²½ ìš”ì²­"
}
```

#### Response

**Success (201 Created)**:
```json
{
  "isSuccess": true,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì •ì´ ëª¨ë‘ ìˆ˜ì •(ìš”ì²­)ë˜ì—ˆìŠµë‹ˆë‹¤.",
  "details": null
}
```

**Error Responses**:

| Status | Error Code | Message | ì„¤ëª… |
|--------|-----------|---------|------|
| 400 | `WORK_DURATION_MISMATCH` | ì‚­ì œí•˜ëŠ” ì¼ì •ì˜ ì´ ê·¼ë¬´ ì‹œê°„ê³¼ ì¶”ê°€í•˜ëŠ” ì¼ì •ì˜ ì´ ê·¼ë¬´ ì‹œê°„ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤. | ì‹œê°„ ë³´ì¡´ ì›ì¹™ ìœ„ë°˜ (detailsì— ì‹¤íŒ¨ ìŠ¬ë¡¯ì´ í¬í•¨ë  ìˆ˜ ìˆìŒ) |
| 400 | `PAST_MONTH_MODIFICATION_NOT_ALLOWED` | ì§€ë‚œ ë‹¬ì˜ ê·¼ë¬´ ì¼ì •ì€ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. | í˜„ì¬ ì›” ì´ì „ ì¼ì • ìˆ˜ì • ì‹œë„ |
| 404 | `SCHEDULE_NOT_FOUND` | í•´ë‹¹ ê·¼ë¬´ ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. | ì·¨ì†Œí•  ì¼ì • IDê°€ ì¡´ì¬í•˜ì§€ ì•ŠìŒ |
| 403 | `UNAUTHORIZED_ACCESS` | í•´ë‹¹ ê·¼ë¬´ ì¼ì •ì— ëŒ€í•œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. | íƒ€ì¸ì˜ ì¼ì • ìˆ˜ì • ì‹œë„ |

#### ìˆ˜ì • ë¡œì§

**ì·¨ì†Œ ë¡œì§**:
- **ì‹ ì²­ ê¸°ê°„ ë‚´**: ì¦‰ì‹œ ì·¨ì†Œ (`WS04`)
- **ì‹ ì²­ ê¸°ê°„ ì™¸**: ì·¨ì†Œ ìš”ì²­ (`CR02` + `CS01`)

**ì¶”ê°€ ë¡œì§**:
- **ì‹ ì²­ ê¸°ê°„ ë‚´**: ì¦‰ì‹œ ìŠ¹ì¸ (`WS02`)
- **ì‹ ì²­ ê¸°ê°„ ì™¸**: ë³€ê²½(ì¶”ê°€) ìš”ì²­ (`CR01` + `CS01`)
- ì¶”ê°€ ì‹œ ëª¨ë“  Validator(ì‹œê°„ ì´ëŸ‰, ë™ì‹œ ì¸ì›) ì¬ê²€ì¦

#### Edge Cases

| ìƒí™© | ì²˜ë¦¬ ë°©ì‹ |
|------|----------|
| **ì‹œê°„ ë¶ˆì¼ì¹˜** | ì·¨ì†ŒëŠ” 2ì‹œê°„ì¸ë° ì¶”ê°€ë¥¼ 3ì‹œê°„ í•˜ë ¤ê³  í•˜ë©´ ì „ì²´ ë¡¤ë°± |
| **ì‚­ì œ ëŒ€ìƒì´ ë³€ê²½ ìš”ì²­ ì¤‘** | ìƒíƒœ ì¶©ëŒ ê°€ëŠ¥ì„± ìˆìŒ |
| **ì§€ë‚œ ë‹¬ ì¼ì •** | ìˆ˜ì • ë¶ˆê°€ |

---

## ğŸ“… ê·¼ë¬´ ì¼ì • ì¡°íšŒ

### 4.1 ì›”ë³„ ì¼ì • ì¡°íšŒ

**Endpoint**: `GET /api/v1/work-schedules`

**ì„¤ëª…**: íŠ¹ì • ì›”ì˜ ë‚˜ì˜ ê·¼ë¬´ ì¼ì • ëª©ë¡ì„ ì¡°íšŒí•©ë‹ˆë‹¤.

#### Request

**Headers**:
```
Authorization: Bearer <JWT_TOKEN>
```

**Query Parameters**:
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `year` | Integer | Yes | ì¡°íšŒí•  ë…„ë„ (ì˜ˆ: 2026) |
| `month` | Integer | Yes | ì¡°íšŒí•  ì›” (1-12) |

**Example**:
```
GET /api/v1/work-schedules?year=2026&month=1
```

#### Response

**Success (200 OK)**:
```json
{
  "isSuccess": true,
  "message": "ê·¼ë¬´ ì¼ì • ì¡°íšŒ ì„±ê³µ",
  "details": {
    "schedules": [
      {
        "id": 123,
        "start": "2026-01-22T09:00:00",
        "end": "2026-01-22T12:00:00",
        "status": "WS02"
      },
      {
        "id": 124,
        "start": "2026-01-25T14:00:00",
        "end": "2026-01-25T16:00:00",
        "status": "WS01"
      }
    ]
  }
}
```

---

### 4.2 ê·¼ë¬´ ì´ë ¥ ì¡°íšŒ

**Endpoint**: `GET /api/v1/work-schedules/history`

**ì„¤ëª…**: íŠ¹ì • ì›”ì˜ ê·¼ë¬´ ì¼ì •ê³¼ ì‹¤ì œ ì¶œí‡´ê·¼ ê¸°ë¡ì„ í•¨ê»˜ ì¡°íšŒí•©ë‹ˆë‹¤. (ì‹¤ê·¼ë¬´ ì‹œê°„ í¬í•¨)

#### Request

**Headers**:
```
Authorization: Bearer <JWT_TOKEN>
```

**Query Parameters**:
| Parameter | Type | Required | Description |
|-----------|------|----------|-------------|
| `year` | Integer | Yes | ì¡°íšŒí•  ë…„ë„ |
| `month` | Integer | Yes | ì¡°íšŒí•  ì›” (1-12) |

**Example**:
```
GET /api/v1/work-schedules/history?year=2026&month=1
```

#### Response

**Success (200 OK)**:
```json
{
  "isSuccess": true,
  "message": "ê·¼ë¬´ ì´ë ¥ ì¡°íšŒ ì„±ê³µ",
  "details": {
    "histories": [
      {
        "id": 123,
        "start": "2026-01-22T09:00:00",
        "end": "2026-01-22T12:00:00",
        "status": "WS02",
        "actualStart": "2026-01-22T09:05:00",
        "actualEnd": "2026-01-22T12:00:00",
        "workDurationMinutes": 175
      },
      {
        "id": 124,
        "start": "2026-01-25T14:00:00",
        "end": "2026-01-25T17:00:00",
        "status": "WS02",
        "actualStart": "2026-01-25T14:00:00",
        "actualEnd": "2026-01-25T17:00:00",
        "workDurationMinutes": 180
      }
    ]
  }
}
```

---

### 4.3 íŠ¹ì • ì¼ì • ìƒì„¸ ì¡°íšŒ

**Endpoint**: `GET /api/v1/work-schedules/{scheduleId}`

**ì„¤ëª…**: íŠ¹ì • ì¼ì •ì˜ ìƒì„¸ ì •ë³´ë¥¼ ì¡°íšŒí•©ë‹ˆë‹¤.

#### Request

**Headers**:
```
Authorization: Bearer <JWT_TOKEN>
```

**Path Parameters**:
| Parameter | Type | Description |
|-----------|------|-------------|
| `scheduleId` | Integer | ì¡°íšŒí•  ì¼ì • ID |

#### Response

**Success (200 OK)**:
```json
{
  "isSuccess": true,
  "message": "ê·¼ë¬´ ì¼ì • ìƒì„¸ ì¡°íšŒ ì„±ê³µ",
  "details": {
    "id": 123,
    "start": "2026-01-22T09:00:00",
    "end": "2026-01-22T12:00:00",
    "status": "WS02"
  }
}
```

---

## ğŸ—‘ï¸ ê·¼ë¬´ ì¼ì • ì·¨ì†Œ

### 5.1 ì¼ì • ì·¨ì†Œ/ì‚­ì œ

**Endpoint**: `DELETE /api/v1/work-schedules/{scheduleId}`

**ì„¤ëª…**: íŠ¹ì • ì¼ì •ì„ ì·¨ì†Œí•©ë‹ˆë‹¤. ì‹ ì²­ ê¸°ê°„ ë‚´ë¼ë©´ ì¦‰ì‹œ ì·¨ì†Œ(`WS04`)ë˜ë©°, ê¸°ê°„ ì™¸ë¼ë©´ ì·¨ì†Œ ìš”ì²­(`CR02`)ìœ¼ë¡œ ë“±ë¡ë©ë‹ˆë‹¤.

#### Request

**Headers**:
```
Authorization: Bearer <JWT_TOKEN>
```

**Path Parameters**:
| Parameter | Type | Description |
|-----------|------|-------------|
| `scheduleId` | Integer | ì·¨ì†Œí•  ì¼ì • ID |

#### Response

**Success (200 OK)**:
```json
{
  "isSuccess": true,
  "message": "ê·¼ë¬´ ì¼ì • ì·¨ì†Œ(ìš”ì²­) ì„±ê³µ",
  "details": null
}
```

**Error Responses**:

| Status | Error Code | Message | ì„¤ëª… |
|--------|-----------|---------|------|
| 404 | `SCHEDULE_NOT_FOUND` | í•´ë‹¹ ê·¼ë¬´ ì¼ì •ì„ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. | ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ì¼ì • ID |
| 403 | `UNAUTHORIZED_ACCESS` | í•´ë‹¹ ê·¼ë¬´ ì¼ì •ì— ëŒ€í•œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤. | íƒ€ì¸ì˜ ì¼ì • ì·¨ì†Œ ì‹œë„ |
| 400 | `PAST_MONTH_MODIFICATION_NOT_ALLOWED` | ì§€ë‚œ ë‹¬ì˜ ê·¼ë¬´ ì¼ì •ì€ ìˆ˜ì •í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. | ì§€ë‚œ ë‹¬ ì¼ì • ì·¨ì†Œ ì‹œë„ |

---

## âœ… ê²€ì¦ ê·œì¹™

### ì‹œê°„ ì œí•œ

| ì œí•œ í•­ëª© | ê¸°ì¤€ | ê°’ | ì—ëŸ¬ ì½”ë“œ |
|----------|------|----|----|
| **ìµœì†Œ ê·¼ë¬´ ì‹œê°„** | 1íšŒ | 2ì‹œê°„ (120ë¶„) | `MIN_WORK_TIME_NOT_MET` |
| **ì£¼ê°„ ìµœëŒ€ ì‹œê°„** | 7ì¼ | 13ì‹œê°„ (780ë¶„) | `WEEKLY_WORK_TIME_EXCEEDED` |
| **ì›”ê°„ ìµœëŒ€ ì‹œê°„** | ì›” | 27ì‹œê°„ (1620ë¶„) | `TOTAL_WORK_TIME_EXCEEDED` |

### ë™ì‹œ ê·¼ë¬´ ì¸ì› ì œí•œ

- **ê²€ì¦ ë‹¨ìœ„**: 15ë¶„ ì²´í¬í¬ì¸íŠ¸(ì‹œì‘+15ë¶„ë¶€í„° 30ë¶„ ê°„ê²©)
- **ê¸°ì¤€**: `MonthlyScheduleConfig.maxConcurrent`
- **ì—ëŸ¬ ì½”ë“œ**: `MAX_CONCURRENT_EXCEEDED`

**ì˜ˆì‹œ**:
```
09:00 - 09:15: 5ëª… (ì œí•œ: 6ëª…) âœ…
09:15 - 09:30: 6ëª… (ì œí•œ: 6ëª…) âœ…
09:30 - 09:45: 7ëª… (ì œí•œ: 6ëª…) âŒ ì´ˆê³¼!
```

### CodeType ìƒíƒœ

| ì½”ë“œ | ì´ë¦„ | ì„¤ëª… |
|------|------|------|
| `WS01` | ì‹ ì²­ë¨ | ê´€ë¦¬ì ìŠ¹ì¸ ëŒ€ê¸° |
| `WS02` | ìŠ¹ì¸ë¨ | ê·¼ë¬´ ê°€ëŠ¥ |
| `WS03` | ê±°ë¶€ë¨ | ê´€ë¦¬ìê°€ ê±°ë¶€ |
| `WS04` | ì·¨ì†Œë¨ | ì‚¬ìš©ì ë˜ëŠ” ê´€ë¦¬ìê°€ ì·¨ì†Œ |

---

## ğŸ”§ ì‹¤ì „ ì›Œí¬í”Œë¡œìš° ë° ì˜ˆì œ

### ì‹œë‚˜ë¦¬ì˜¤ 1: ì‹ ì²­ ê¸°ê°„ ë‚´ ì¼ì • ì‹ ì²­ (ì¦‰ì‹œ ìŠ¹ì¸)

**ìƒí™©**: 1ì›” 23ì¼ (ì‹ ì²­ ê¸°ê°„ ë‚´)ì— ì‚¬ìš©ìê°€ 3ê°œ ì¼ì • ì‹ ì²­ â†’ 2ê°œ ì„±ê³µ, 1ê°œ ë™ì‹œì¸ì› ì´ˆê³¼ë¡œ ì‹¤íŒ¨

**1ï¸âƒ£ ì‹ ì²­ ê¸°ê°„ í™•ì¸**
```bash
curl -X GET "http://localhost:8080/api/v1/admin/schedule/monthly-limit/2026/01" \
  -H "Authorization: Bearer <ADMIN_TOKEN>" \
  -H "Content-Type: application/json"

# ì‘ë‹µ: applyStartTime: "2025-12-23", applyEndTime: "2025-12-27"
# í˜„ì¬: 2026-01-23 â†’ ì‹ ì²­ ê¸°ê°„ ì™¸! (ê¸°ê°„ì´ ì§€ë‚¬ìŒ)
```

**2ï¸âƒ£ ì¼ì • ì‹ ì²­**
```bash
curl -X POST "http://localhost:8080/api/v1/work-schedules/apply" \
  -H "Authorization: Bearer <USER_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{
    "applySlots": [
      {
        "start": "2026-01-25T09:00:00",
        "end": "2026-01-25T11:00:00"
      },
      {
        "start": "2026-01-25T14:00:00",
        "end": "2026-01-25T17:00:00"
      },
      {
        "start": "2026-01-25T19:00:00",
        "end": "2026-01-25T20:00:00"
      }
    ]
  }'
```

**3ï¸âƒ£ ì‘ë‹µ (207 Multi-Status - ë¶€ë¶„ ì„±ê³µ)**
```json
{
  "isSuccess": false,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì • ì¤‘ ì‹¤íŒ¨í•œ ì¼ì •ì´ ì¡´ì¬í•©ë‹ˆë‹¤.",
  "details": {
    "success": [
      {"start": "2026-01-25T09:00:00", "end": "2026-01-25T11:00:00"},
      {"start": "2026-01-25T14:00:00", "end": "2026-01-25T17:00:00"}
    ],
    "fail": [
      {
        "start": "2026-01-25T19:00:00",
        "end": "2026-01-25T20:00:00",
        "reason": "ë™ì‹œ ê·¼ë¬´ ì¸ì› ì´ˆê³¼"
      }
    ]
  }
}
```

**4ï¸âƒ£ í”„ë¡ íŠ¸ì—”ë“œ ì²˜ë¦¬**
```typescript
// TypeScript ì˜ˆì œ
interface ApplyResponse {
  isSuccess: boolean;
  message: string;
  details: {
    success: Array<{start: string; end: string}>;
    fail: Array<{start: string; end: string; reason: string}>;
  };
}

async function applyWorkSchedule(slots: Slot[]) {
  const response = await fetch('/api/v1/work-schedules/apply', {
    method: 'POST',
    headers: {
      'Authorization': `Bearer ${accessToken}`,
      'Content-Type': 'application/json'
    },
    body: JSON.stringify({ applySlots: slots })
  });

  const data: ApplyResponse = await response.json();

  // ë¶€ë¶„ ì„±ê³µ ì²˜ë¦¬ (207)
  if (response.status === 207) {
    showAlert(`${data.details.success.length}ê°œ ìŠ¹ì¸, ${data.details.fail.length}ê°œ ì‹¤íŒ¨`);
    data.details.fail.forEach(f => {
      console.log(`${f.start} ~ ${f.end}: ${f.reason}`);
    });
  }

  // ì „ì²´ ì‹¤íŒ¨ ì²˜ë¦¬ (422)
  if (response.status === 422) {
    showError('ëª¨ë“  ì¼ì •ì´ ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•˜ì„¸ìš”.');
  }

  return data;
}
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 2: ê²€ì¦ ì‹¤íŒ¨ ì‹œë‚˜ë¦¬ì˜¤

**âŒ ì—ëŸ¬ 1: ìµœì†Œ ê·¼ë¬´ ì‹œê°„ ë¯¸ì¶©ì¡± (2ì‹œê°„ ë¯¸ë§Œ)**
```bash
curl -X POST "http://localhost:8080/api/v1/work-schedules/apply" \
  -H "Authorization: Bearer <USER_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{
    "applySlots": [
      {
        "start": "2026-01-25T09:00:00",
        "end": "2026-01-25T10:30:00"  # 1ì‹œê°„ 30ë¶„ë§Œ!
      }
    ]
  }'

# ì‘ë‹µ 422
{
  "isSuccess": false,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì •ì´ ëª¨ë‘ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.",
  "details": {
    "success": [],
    "fail": [
      {
        "start": "2026-01-25T09:00:00",
        "end": "2026-01-25T10:30:00",
        "reason": "ìµœì†Œ ê·¼ë¬´ ì‹œê°„(2ì‹œê°„) ë¯¸ì¶©ì¡±"
      }
    ]
  }
}
```

**âŒ ì—ëŸ¬ 2: ì›”ê°„ ìµœëŒ€ ì‹œê°„ ì´ˆê³¼ (27ì‹œê°„)**
```bash
# ì‚¬ìš©ìê°€ ì´ë¯¸ 25ì‹œê°„ ì‹ ì²­í•œ ìƒíƒœì—ì„œ 4ì‹œê°„ ì¶”ê°€ ì‹œë„
curl -X POST "http://localhost:8080/api/v1/work-schedules/apply" \
  -H "Authorization: Bearer <USER_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{
    "applySlots": [
      {
        "start": "2026-01-28T09:00:00",
        "end": "2026-01-28T13:00:00"  # 4ì‹œê°„ (ì´ 29ì‹œê°„ = ì´ˆê³¼!)
      }
    ]
  }'

# ì‘ë‹µ 422
{
  "isSuccess": false,
  "message": "ì‹ ì²­í•˜ì‹  ì¼ì •ì´ ëª¨ë‘ ì‹¤íŒ¨í•˜ì˜€ìŠµë‹ˆë‹¤.",
  "details": {
    "fail": [
      {
        "reason": "ì›”ê°„ ìµœëŒ€ ì‹œê°„(27ì‹œê°„) ì´ˆê³¼: í˜„ì¬ 25ì‹œê°„ + ì‹ ì²­ 4ì‹œê°„ = 29ì‹œê°„"
      }
    ]
  }
}
```

**âŒ ì—ëŸ¬ 3: ê¶Œí•œ ì—†ìŒ (íƒ€ì¸ì˜ ì¼ì • ì·¨ì†Œ ì‹œë„)**
```bash
curl -X DELETE "http://localhost:8080/api/v1/work-schedules/123" \
  -H "Authorization: Bearer <USER_A_TOKEN>"

# ì‘ë‹µ 403 (123ë²ˆ ì¼ì •ì´ USER_Bì˜ ì¼ì •)
{
  "isSuccess": false,
  "message": "í•´ë‹¹ ê·¼ë¬´ ì¼ì •ì— ëŒ€í•œ ê¶Œí•œì´ ì—†ìŠµë‹ˆë‹¤.",
  "details": null
}
```

---

### ì‹œë‚˜ë¦¬ì˜¤ 3: ì¼ì • ìˆ˜ì • (ì‹œê°„ ë³´ì¡´)

**ìƒí™©**: ê¸°ì¡´ 2ì‹œê°„ ì¼ì •ì„ ì‚­ì œí•˜ê³ , ë‹¤ë¥¸ ì‹œê°„ì— 2ì‹œê°„ ì¶”ê°€

```bash
curl -X PATCH "http://localhost:8080/api/v1/work-schedules/modify" \
  -H "Authorization: Bearer <USER_TOKEN>" \
  -H "Content-Type: application/json" \
  -d '{
    "cancelScheduleIds": [123],  # 2ì‹œê°„ ì¼ì •
    "applySlots": [
      {
        "start": "2026-01-26T10:00:00",
        "end": "2026-01-26T12:00:00"  # 2ì‹œê°„ (ì‹œê°„ ë³´ì¡´!)
      }
    ],
    "reason": "ì‹œê°„ ë³€ê²½ ìš”ì²­"
  }'

# ì‘ë‹µ 200
{
  "isSuccess": true,
  "message": "ê·¼ë¬´ ì¼ì • ìˆ˜ì • ì™„ë£Œ",
  "details": {
    "cancelledSchedules": [123],
    "newSchedules": [
      {
        "id": 999,
        "start": "2026-01-26T10:00:00",
        "end": "2026-01-26T12:00:00",
        "status": "WS02"  # ì‹ ì²­ ê¸°ê°„ ë‚´ë©´ ì¦‰ì‹œ ìŠ¹ì¸
      }
    ]
  }
}
```

**âŒ ì—ëŸ¬: ì‹œê°„ ë¶ˆì¼ì¹˜**
```bash
# 2ì‹œê°„ ì·¨ì†Œ but 3ì‹œê°„ ì¶”ê°€ ì‹œë„
{
  "cancelScheduleIds": [123],     # 2ì‹œê°„
  "applySlots": [
    {"start": "2026-01-26T10:00:00", "end": "2026-01-26T13:00:00"}  # 3ì‹œê°„
  ]
}

# ì‘ë‹µ 400
{
  "isSuccess": false,
  "message": "ì·¨ì†Œ ì‹œê°„ê³¼ ì‹ ì²­ ì‹œê°„ì´ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.",
  "details": {
    "cancelledTime": "120ë¶„",
    "appliedTime": "180ë¶„",
    "difference": "60ë¶„"
  }
}
```

---

## âš ï¸ ìì£¼ í•˜ëŠ” ì‹¤ìˆ˜ ë° í•´ê²°ì±…

| ì‹¤ìˆ˜ | ì›ì¸ | í•´ê²°ì±… | ì°¸ê³  |
|------|------|--------|------|
| **ì¼ì •ì´ ìë™ ìŠ¹ì¸ ì•ˆ ë¨** | ì‹ ì²­ ê¸°ê°„ ì™¸ì— ì‹ ì²­í•¨ | ì‹ ì²­ ê¸°ê°„ í™•ì¸: `GET /admin/schedule/monthly-limit/{year}/{month}` | ê¸°ê°„ ë‚´ë§Œ ì¦‰ì‹œ ìŠ¹ì¸ |
| **ë™ì‹œì¸ì› ì´ˆê³¼ ì—ëŸ¬** | ë™ì¼ ì‹œê°„ëŒ€ì— ì¸ì› ì´ˆê³¼ | ë‹¤ë¥¸ ì‹œê°„ëŒ€ë¡œ ë³€ê²½ ë˜ëŠ” ê¸°ì¡´ ì¼ì • ì‚­ì œ í›„ ì¬ì‹ ì²­ | 15ë¶„ ë‹¨ìœ„ë¡œ ì²´í¬ |
| **ìµœì†Œ ì‹œê°„ ë¯¸ì¶©ì¡±** | 2ì‹œê°„ ë¯¸ë§Œ ì‹ ì²­ | ìµœì†Œ 2ì‹œê°„ ì´ìƒìœ¼ë¡œ ì‹ ì²­ | 1íšŒ ìµœì†Œ 2ì‹œê°„ |
| **ì›”ê°„ ì œí•œ ì´ˆê³¼** | ì›” 27ì‹œê°„ ì´ˆê³¼ ì‹ ì²­ | ë‹¤ìŒ ë‹¬ë¡œ ì—°ê¸° ë˜ëŠ” ê¸°ì¡´ ì¼ì • ì·¨ì†Œ | ì›” ìµœëŒ€ 27ì‹œê°„ |
| **ìˆ˜ì • ì‹œ ì‹œê°„ ë¶ˆì¼ì¹˜** | ì·¨ì†Œ/ì¶”ê°€ ì‹œê°„ ë‹¤ë¦„ | ì·¨ì†Œì™€ ì¶”ê°€ ì‹œê°„ì„ ì •í™•íˆ ë§ì¶¤ | "ì‹œê°„ ë³´ì¡´ì˜ ë²•ì¹™" |
| **íƒ€ì¸ ì¼ì • ì·¨ì†Œ ë¶ˆê°€** | ë‹¤ë¥¸ ì‚¬ìš©ì ì¼ì • ì·¨ì†Œ ì‹œë„ | ë³¸ì¸ ì¼ì •ë§Œ ì·¨ì†Œ ê°€ëŠ¥ | ê´€ë¦¬ì API ì‚¬ìš© |
| **í† í° ë§Œë£Œ** | ì˜¤ë˜ëœ AccessToken ì‚¬ìš© | `/auth/refresh`ë¡œ ìƒˆ í† í° ë°œê¸‰ | 1ì‹œê°„ ìœ íš¨ |

---

## ğŸ”— ê´€ë ¨ ë¬¸ì„œ

### ì—°ê´€ API
- [ê´€ë¦¬ì API](./admin.md) - ì›”ë³„ ì œí•œ ì„¤ì •, ë³€ê²½ ìš”ì²­ ì²˜ë¦¬
- [ì¶œí‡´ê·¼ API](./attendance.md) - QR ì²´í¬ì¸/ì•„ì›ƒ
- [ëŒ€ì‹œë³´ë“œ API](./home.md) - ê·¼ë¬´ ì‹œê°„ ìš”ì•½

### ê·œì•½ ë° ì‹œìŠ¤í…œ
- [ì—ëŸ¬ ì²˜ë¦¬ ê·œì•½](../conventions/error-handling.md)
- [API ì„¤ê³„ ê·œì•½](../conventions/api-conventions.md)
- [ì½”ë“œ ì‹œìŠ¤í…œ](../database/schema/code-system.md) - WorkStatus(`WS`), ChangeRequest(`CR`)

### ë°ì´í„°ë² ì´ìŠ¤
- [WorkSchedule ìŠ¤í‚¤ë§ˆ](../database/README.md)
- [MonthlyScheduleLimit ìŠ¤í‚¤ë§ˆ](../database/README.md)

### ìƒìœ„ ë¬¸ì„œ
- â¬†ï¸ [API ë¬¸ì„œ í™ˆ](./README.md)
- â¬†ï¸ [ë¬¸ì„œ í—ˆë¸Œ](../README.md)
